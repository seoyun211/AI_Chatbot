<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Baekjoon Chatbot</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* ê¸°ì¡´ style-popupì€ ë°ì€ í…Œë§ˆ */
    #style-popup {
      background: white;
      color: black;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      display: none;
    }

    /* ë‹¤í¬ ëª¨ë“œ ì „ìš© style-popup */
    body.dark-mode #style-popup {
      background: #333;
      color: #fff;
      border: 2px solid #888;
    }

    body.dark-mode #style-popup button {
      background-color: #444;
      color: #fff;
      border: 1px solid #aaa;
    }

    body.dark-mode #style-popup button:hover {
      background-color: #555;
    }

    .button-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .chat-button {
      padding: 10px 15px;
      background-color: #f5f5f5;
      color: rgb(16, 43, 30);
      border: none;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .chat-button:hover {
      background-color: #bdbdbd
    }

    /* ì¼ë°˜ ëª¨ë“œì—ì„œ ë©”ë‰´ í•­ëª©ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ë°°ê²½ ê°•ì¡° ìƒ‰ìƒ */
    .sidebar .menu-item:hover {
      background-color: #f0f0f0;
    }

    /* ë‹¤í¬ ëª¨ë“œì—ì„œ ë©”ë‰´ í•­ëª©ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ë°°ê²½ê³¼ ê¸€ì”¨ ê°•ì¡° ìƒ‰ìƒ */
    .dark-mode .sidebar .menu-item:hover {
      background-color: #444;
      color: #fff;
    }
  </style>
</head>

<body>
  <!-- ğŸ‘¤ ë°±ì¤€ ì•„ì´ë”” ì…ë ¥ í™”ë©´ -->
  <div class="intro-container" id="intro-page">
    <h2>ğŸ‘‹ ë°±ì¤€ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”</h2>
    <input type="text" id="boj-username" placeholder="ex joonas123" style="padding: 10px; font-size: 16px;" />
    <br /><br />
    <button onclick="startChat()" style="padding: 10px 20px; font-size: 16px;">ì‹œì‘í•˜ê¸°</button>
  </div>

  <!-- ğŸ¤– ì±—ë´‡ í™”ë©´ -->
  <div class="container" id="chat-page" style="display: none;">
    <div class="menu-button" onclick="toggleSidebar()">&#9776;</div>

    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar" id="sidebar">
      <div class="menu-item" onclick="clearChat()">ğŸ“„ ìƒˆ ì±„íŒ…</div>
      <div class="menu-item" onclick="openSettings()">âš™ ì„¤ì •</div>
      <div class="menu-item" onclick="openGoalModal()">ğŸ¯ ëª©í‘œ ì„¤ì •</div>
    </div>

    <!-- ì„¤ì • í˜ì´ì§€ -->
    <div class="settings-page" id="settings-page" style="display: none;">
      <div class="settings-header" id="settings-header">
        <span>âš™ ì„¤ì •</span>
        <div class="window-controls">
          <button class="close-btn" onclick="closeSettings()">X</button>
        </div>
      </div>
      <div class="menu-item" onclick="toggleStylePopup()">ğŸ¹ í‚¤ë³´ë“œ</div>
      <div id="style-popup" style="display:none; position:fixed; top:60%; left:50%;
        background:white; padding:15px; border:1px solid #ccc; border-radius:10px;
        box-shadow:0 2px 10px rgba(0,0,0,0.2); z-index:1001; min-width: 260px;">
        <!-- ğŸ”§ í—¤ë” ì˜ì—­ -->
        <div class="popup-header" id="popup-drag-header"
          style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; cursor: move;">
          <strong class="popup-title">ğŸ’¡ ê¸€ì”¨ í¬ê¸° ë³€ê²½</strong>
          <button onclick="closeStylePopup()"
            style="background:none; border:none; font-size: 16px; cursor:pointer;">âŒ</button>
        </div>
        <!-- ë²„íŠ¼ ì˜ì—­ -->
        <div class="button-group">
          <button class="font-button" onclick="setFontSize('small')">ì‘ê²Œ</button>
          <button class="font-button" onclick="setFontSize('medium')">ë³´í†µ</button>
          <button class="font-button" onclick="setFontSize('large')">í¬ê²Œ</button>
        </div>
      </div>
      <label><input type="checkbox" id="dark-mode-toggle" /> ë‹¤í¬ ëª¨ë“œ í™œì„±í™”</label><br />
      <button onclick="saveChatHistory()">ğŸ’¾ ì±„íŒ… ì €ì¥</button>
      <button onclick="loadChatHistory()">ğŸ“‚ ì±„íŒ… ë¶ˆëŸ¬ì˜¤ê¸°</button>
    </div>

    <!-- ì±„íŒ…ì°½ -->
    <div class="chat-container">
      <div class="chat-box" id="chat-box"></div>
      <textarea class="input-box" id="input-box" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”." rows="3"></textarea>
      <button class="send-button" onclick="sendMessage()">ì „ì†¡</button>
    </div>
    <!-- ëª©í‘œ ì„¤ì • íŒì—… ëª¨ë‹¬ -->
    <div id="goal-modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeGoalModal()">&times;</span>
        <h3>ğŸ¯ ì˜¤ëŠ˜ì˜ ëª©í‘œ ì„¤ì •</h3>
        <label>ì˜¤ëŠ˜ ëª©í‘œ ë¬¸ì œ ìˆ˜:
          <input type="number" id="daily-goal" placeholder="ì˜ˆ: 5" />
        </label>
        <button onclick="saveGoal()">ì €ì¥</button>

        <div style="margin-top: 20px;">
          <p>í˜„ì¬ í‘¼ ë¬¸ì œ ìˆ˜: <span id="solved-count">0</span></p>
          <p>ì§„í–‰ë¥ :</p>
          <div style="background: #eee; border-radius: 10px; height: 20px; width: 100%;">
            <div id="goal-progress-bar" style="height: 100%; background: #4caf50; width: 0%; border-radius: 10px;">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function startChat() {
      const username = document.getElementById('boj-username').value.trim();
      if (!username) {
        alert('ë°±ì¤€ ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
      }
      localStorage.setItem('bojUsername', username);
      document.getElementById('intro-page').style.display = 'none';
      document.getElementById('chat-page').style.display = 'flex';

      displayMessage(`${username}ë‹˜, ë¬´ì—‡ì„ ë¶„ì„í•´ ë“œë¦´ê¹Œìš”?`, 'bot-message');
      showMainOptions();
    }

    async function sendMessage(skipUserMessage = false) {
      const inputBox = document.getElementById('input-box');
      const fileInput = document.getElementById('file-input');
      const message = inputBox.value.trim();
      const bojUsername = localStorage.getItem('bojUsername') || "";

      if (!message) return;

      if (!skipUserMessage) {
        displayMessage(message, 'user-message');
      }

      inputBox.value = '';

      const formData = new FormData();
      formData.append('question', message);
      formData.append('boj_username', bojUsername);

      const url = fileInput && fileInput.files && fileInput.files.length > 0 ? 'http://127.0.0.1:8000/analyze' : 'http://127.0.0.1:8000/chat';

      try {
        const response = await fetch(url, { method: 'POST', body: formData });
        const data = await response.json();
        displayMessage(data.summary || data.answer || "ì˜¤ë¥˜ ë°œìƒ", 'bot-message');
      } catch (error) {
        displayMessage("âš  ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ", 'bot-message');
      }
    }

    function displayMessage(msg, className) {
      const chatBox = document.getElementById('chat-box');
      const div = document.createElement('div');
      div.className = `message ${className}`;
      div.innerHTML = msg;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    document.getElementById('input-box').addEventListener('keydown', function (e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    document.getElementById('dark-mode-toggle').addEventListener('change', function () {
      document.body.classList.toggle('dark-mode', this.checked);
      localStorage.setItem('darkMode', this.checked);
    });

    window.onload = function () {
      const savedDark = localStorage.getItem('darkMode') === 'true';
      document.body.classList.toggle('dark-mode', savedDark);
      document.getElementById('dark-mode-toggle').checked = savedDark;
    };

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
    }

    function clearChat() {
      document.getElementById('chat-box').innerHTML = '<div class="message bot-message">ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?</div>';
      showMainOptions(); // ìƒˆ ì±„íŒ… ì‹œ ë‹¤ì‹œ ë²„íŠ¼ ë³´ì—¬ì¤Œ
    }

    function openSettings() {
      document.getElementById('settings-page').style.display = 'block';
    }

    function closeSettings() {
      document.getElementById('settings-page').style.display = 'none';
    }

    function toggleStylePopup() {
      const popup = document.getElementById("style-popup");
      popup.style.display = popup.style.display === "none" ? "block" : "none";
    }

    function setFontSize(size) {
      const messages = document.querySelectorAll('.bot-message, .user-message');
      messages.forEach(msg => {
        msg.classList.remove('size-small', 'size-medium', 'size-large');
        msg.classList.add(`size-${size}`);
      });
    }

    function saveChatHistory() {
      localStorage.setItem('chatHistory', document.getElementById('chat-box').innerHTML);
      alert('ì±„íŒ…ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    function loadChatHistory() {
      const savedChat = localStorage.getItem('chatHistory');
      if (savedChat) {
        document.getElementById('chat-box').innerHTML = savedChat;
      } else {
        alert('ì €ì¥ëœ ì±„íŒ…ì´ ì—†ìŠµë‹ˆë‹¤.');
      }
    }

    // âœ… ë¶„ì„ ë²„íŠ¼ UI ì¶œë ¥
    function showMainOptions() {
      const chatBox = document.getElementById('chat-box');

      const buttonContainer = document.createElement('div');
      buttonContainer.className = 'button-container';
      buttonContainer.style.marginTop = '15px';
      buttonContainer.style.marginBottom = '15px';


      const buttons = [
        { label: 'ğŸ‘¤ ë‚´ ë°±ì¤€ ì •ë³´ ë³´ê¸°', message: 'ë‚´ ë°±ì¤€ ì •ë³´ ë³´ê¸°' },
        { label: 'ğŸ“Š í’€ì´ ë¶„í¬ ë³´ê¸°', message: 'í’€ì´ ë¶„í¬ ë³´ê¸°' },
        { label: 'ğŸ“ˆ ë‚œì´ë„ ì¶”ì„¸', message: 'ë‚œì´ë„ ì¶”ì„¸' },
        { label: 'ğŸ† ë„ì „ ê³¼ì œ ìƒì„±', message: 'ë„ì „ ê³¼ì œ ìƒì„±' },
        { label: 'ğŸ§  ì•Œê³ ë¦¬ì¦˜ë³„ ë¶„ì„', message: 'ì•Œê³ ë¦¬ì¦˜ë³„ ë¶„ì„' },
        { label: 'â± í‰ê·  í’€ì´ ì‹œê°„', message: 'í‰ê·  í’€ì´ ì‹œê°„' },
        { label: 'ğŸ¤– AI ë¬¸ì œ ì¶”ì²œ', message: 'AIë¬¸ì œ ì¶”ì²œ' },
        { label: 'ğŸ² ëœë¤ ë¬¸ì œ ì¶”ì²œ', message: 'ëœë¤ ë¬¸ì œ ì¶”ì²œ' },
        { label: 'ğŸ‘‘ ë­í‚¹ ì‹œë®¬ë ˆì´ì…˜', message: 'ë­í‚¹ ì‹œë®¬ë ˆì´ì…˜' },
      ];

      buttons.forEach(btn => {
        const button = document.createElement('button');
        button.textContent = btn.label;
        button.className = 'chat-button';
        button.onclick = () => {
          displayMessage(` ${btn.label}`, 'user-message');
          sendAutoMessage(btn.message);
        };
        buttonContainer.appendChild(button);
      });

      chatBox.appendChild(buttonContainer);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // âœ… ë²„íŠ¼ í´ë¦­ ì‹œ ìë™ ë©”ì‹œì§€ ì „ì†¡ 
    function sendAutoMessage(message) {
      const inputBox = document.getElementById('input-box');
      inputBox.value = message;

      if (message === "ë‚´ ë°±ì¤€ ì •ë³´ ë³´ê¸°") {
      const username = localStorage.getItem('bojUsername');
      if (username) {
        fetchUserInfo(username);
      } else {
        displayMessage("âš  ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", 'bot-message');
        } 
      } else if (message === "ëœë¤ ë¬¸ì œ ì¶”ì²œ") {
        recommendProblem();  // ëœë¤ ë¬¸ì œ ì¶”ì²œ ì‹œ recommendProblem í˜¸ì¶œ
      } else if (message === "í’€ì´ ë¶„í¬ ë³´ê¸°") {
        showDistribution();
      } else {
      sendMessage(true);
      }
      
    }

    function closeStylePopup() {
      document.getElementById("style-popup").style.display = "none";
    }

    // ë‚´ì •ë³´
    async function fetchUserInfo(username) {
      try {
        const res = await fetch(`http://127.0.0.1:8000/userinfo?boj_username=${username}`);
        const data = await res.json();
        if (data.error) {
          alert(data.error);
        } else {
          const cardHTML = `
        <div class="boj-card">
          <div class="boj-card-header">ğŸ‘¤ ${username}ë‹˜ì˜ ë°±ì¤€ ì •ë³´</div>
          <div class="boj-info-grid">
            <div class="info-item">ğŸ– í‹°ì–´:<strong>${data.tier}</strong></div>
            <div class="info-item">ğŸ“ˆ ë­í‚¹:<strong>${data.rank}</strong></div>
            <div class="info-item">âœ… í‘¼ ë¬¸ì œ ìˆ˜:<strong>${data.solved_count}</strong></div>
            <div class="info-item">ğŸ« í´ë˜ìŠ¤:<strong>${data.class}</strong></div>
            <div class="info-item">ğŸ”¥ ìµœì¥ ìŠ¤íŠ¸ë¦­:<strong>${data.max_streak}</strong></div>
            <div class="info-item">ğŸ“Š ì‹¤ë ¥ ì ìˆ˜:<strong>${data.rating}</strong></div>
          </div>
        </div>
      `;
      displayMessage(cardHTML, 'bot-message');  // HTML ì¶œë ¥ í•¨ìˆ˜
    }
      } catch (e) {
        displayMessage("âš  ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", 'bot-message');
      }
    }
    // ëœë¤ë¬¸ì œì¶”ì²œ
async function recommendProblem() {
  const bojUsername = localStorage.getItem('bojUsername');
  if (!bojUsername) {
    displayMessage("âš  ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.", 'bot-message');
    return;
  }

  try {
    const res = await fetch(`http://127.0.0.1:8000/recommend?boj_username=${bojUsername}`);
    const data = await res.json();

    if (data.error) {
      displayMessage(data.error, 'bot-message');
    } else {
      const problemLink = `https://www.acmicpc.net/problem/${data.problemId}`;
      const tierImageUrl = `https://static.solved.ac/tier_small/${data.tier}.svg`;

      const cardHtml = `
        <div style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          background: #ffffff;
          border-radius: 12px;
          box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
          padding: 16px;
          margin: 18px 0;
          max-width: 640px;
        ">
          <div style="flex: 1; padding-right: 16px;">
            <h3 style="margin: 0 0 8px 0; font-size: 18px;">ğŸ§  ${data.title}</h3>
            <p style="margin: 2px 0;">ğŸ“Œ ë¬¸ì œ ë²ˆí˜¸: <strong>${data.problemId}</strong></p>
            <p style="margin: 2px 0;">â­ í‹°ì–´: ${data.tier}</p>
            <p style="margin: 6px 0; color: #444; font-size: 13.5px; line-height: 1.4;"> ì´ ë¬¸ì œëŠ” ì‹¤ë ¥ í–¥ìƒì— ì í•©í•œ ì•Œê³ ë¦¬ì¦˜ ìœ í˜•ìœ¼ë¡œ ì¶”ì²œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            <a href="${problemLink}" target="_blank" style="
              display: inline-block;
              margin-top: 6px;
              padding: 6px 12px;
              background-color: #4CAF50;
              color: white;
              border-radius: 16px;
              text-decoration: none;
              font-weight: bold;
              font-size: 14px;
              transition: background 0.3s;
            " onmouseover="this.style.backgroundColor='#45a049'" onmouseout="this.style.backgroundColor='#4CAF50'"> ğŸ‘‰ ë¬¸ì œ í’€ëŸ¬ ê°€ê¸°
            </a>
          </div>
          <div style="flex-shrink: 0;">
            <img src="${tierImageUrl}" alt="í‹°ì–´" style="width: 64px; height: 64px;" />
          </div>
        </div>
      `;

      const chatBox = document.getElementById("chat-box");
      const div = document.createElement("div");
      div.className = "message bot-message";
      div.innerHTML = cardHtml;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  } catch (error) {
    displayMessage("âš  ì¶”ì²œ ë¬¸ì œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", 'bot-message');
  }
}
let chartInstance = null;  // ì „ì—­ìœ¼ë¡œ Chart ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥

async function showDistribution() {
  const bojUsername = localStorage.getItem('bojUsername');
  if (!bojUsername) {
    displayMessage("âš  ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.", 'bot-message');
    return;
  }

  try {
    const res = await fetch(`http://127.0.0.1:8000/distribution?boj_username=${bojUsername}`);
    const data = await res.json();

    if (data.error) {
      displayMessage(data.error, 'bot-message');
      return;
    }

    // âœ… ìˆ˜ì •ëœ ë¶€ë¶„: ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° í•„ë“œ ì •í™•íˆ ë§ì¶¤
    const levels = data.levels;
    const counts = data.counts;

    console.log("ğŸ“Š levels", levels);
    console.log("ğŸ“Š counts", counts);

    const canvasId = 'difficulty-chart';
    const chartHtml = `
      <div style="max-width: 500px; margin-top: 16px;">
        <h4>ğŸ“Š ë‚œì´ë„ ë³„ í’€ì´ ë¶„í¬</h4>
        <canvas id="${canvasId}" width="400" height="300"></canvas>
      </div>
    `;
    displayMessage(chartHtml, 'bot-message');

    // DOM ê·¸ë ¤ì§„ ë‹¤ìŒ ì•ˆì „í•˜ê²Œ ì‹¤í–‰
    setTimeout(() => {
      const ctx = document.getElementById(canvasId)?.getContext('2d');
      if (!ctx) {
        console.error("ğŸ¯ canvasë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }

      // ì´ì „ ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì œê±°
      if (chartInstance !== null) {
        chartInstance.destroy();
      }

      chartInstance = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: levels,
    datasets: [{
      label: 'í’€ì´í•œ ë¬¸ì œ ìˆ˜',
      data: counts,
      backgroundColor: '#4CAF50',
      borderRadius: 8,
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: {
      y: {
        beginAtZero: true,
        // âœ… ì—¬ê¸° ì¶”ê°€: ìµœëŒ€ê°’ ì„¤ì • (ìë™ ìµœëŒ€ê°’ì´ ë„ˆë¬´ ì‘ì„ ë•Œ ëŒ€ë¹„)
        suggestedMax: Math.max(...counts) + 10,  // ìµœëŒ“ê°’ + ì—¬ìœ 
        ticks: {
          stepSize: 1
        }
      }
    }
  }
});


    }, 150);  // DOM ìƒì„± ëŒ€ê¸° ì‹œê°„

  } catch (err) {
    displayMessage("âš  ë¶„í¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", 'bot-message');
  }
}



    const settingsPage = document.getElementById("settings-page");
    const settingsHeader = document.getElementById("settings-header");

    let draggingSettings = false;
    let offsetX_settings = 0;
    let offsetY_settings = 0;

    settingsHeader.addEventListener("mousedown", function (e) {
      // ì„¤ì •ì°½ì˜ í˜„ì¬ ìœ„ì¹˜ë¥¼ ì‹¤ì œ ì¢Œí‘œë¡œ ê³„ì‚°
      const rect = settingsPage.getBoundingClientRect();

      // transformì„ ì—†ì• ê³  í˜„ì¬ ìœ„ì¹˜ë¥¼ top/leftë¡œ ê³ ì •
      settingsPage.style.left = `${rect.left}px`;
      settingsPage.style.top = `${rect.top}px`;
      settingsPage.style.transform = "none"; // ì¤‘ìš”!!

      offsetX_settings = e.clientX - rect.left;
      offsetY_settings = e.clientY - rect.top;
      draggingSettings = true;
    });

    document.addEventListener("mousemove", function (e) {
      if (!draggingSettings) return;

      const x = e.clientX - offsetX_settings;
      const y = e.clientY - offsetY_settings;

      settingsPage.style.left = `${x}px`;
      settingsPage.style.top = `${y}px`;
    });

    document.addEventListener("mouseup", function () {
      draggingSettings = false;
    });

    let solvedToday = 0;
    let dailyGoal = 0;

    function toggleGoalPanel() {
      const panel = document.getElementById("goal-panel");
      panel.style.display = panel.style.display === "none" ? "block" : "none";
    }

    function saveGoal() {
      const input = document.getElementById("daily-goal").value;
      dailyGoal = parseInt(input);
      updateProgressBar();
    }

    function updateSolvedCount(count) {
      solvedToday = count;
      document.getElementById("solved-count").innerText = solvedToday;
      updateProgressBar();
    }

    function updateProgressBar() {
      if (dailyGoal === 0) return;
      const percent = Math.min((solvedToday / dailyGoal) * 100, 100);
      document.getElementById("goal-progress-bar").style.width = percent + "%";
    }

    function openGoalModal() {
      document.getElementById("goal-modal").style.display = "block";
    }

    function closeGoalModal() {
      document.getElementById("goal-modal").style.display = "none";
    }
  </script>
</body>

</html>